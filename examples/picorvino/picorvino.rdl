struct picorvino_params{
    longint unsigned ram_base;
    longint unsigned ram_size;

    longint unsigned boot_base;
    longint unsigned boot_size;
};

addrmap picorvino #(
    base_bus BUS = base_bus'{name:"nmi_bus", ADDR_WIDTH:32, DATA_WIDTH:32},
    picorvino_params PARAMS = picorvino_params'{
            boot_base: 0x00000000,
            boot_size: 1024,

            ram_base: 0x00001000,
            ram_size: 16384
        }
){
    name = "Picorvino";
    subsystem;
    bus_inst = BUS;

    picorv32 #(
        .PROGADDR_RESET(PARAMS.boot_base),
        .PROGADDR_IRQ(PARAMS.boot_base + 0x10),
        .STACKADDR(PARAMS.ram_base + PARAMS.ram_size-1)

    ) picorv32 @ 0xFFFFFFF0;

    // Memories
    nmi_memory #(
        .MEM_SIZE(1024),
        .BUS(base_bus'{name:"nmi_bus", ADDR_WIDTH:32, DATA_WIDTH:32})
        ) bootmem @ PARAMS.boot_base;

    nmi_memory #(
        .MEM_SIZE(64000),
        .BUS(base_bus'{name:"nmi_bus", ADDR_WIDTH:32, DATA_WIDTH:32})
        ) mem0 @ PARAMS.ram_base;

        clk clk;
        rstn rstn;

};

